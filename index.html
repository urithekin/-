<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>× ×—×© ××™: ××•×œ×™××¤×•×¡ ×¤×¨×•</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #0f172a; color: #f8fafc; font-family: 'Segoe UI', system-ui; text-align: center; margin: 0; }
        .top { background: linear-gradient(135deg, #b89130, #927425); padding: 15px; border-bottom: 3px solid #fff; color: #1e293b; position: sticky; top: 0; z-index: 100; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 15px; padding: 25px; max-width: 1000px; margin: auto; }
        .card { background: #fff; color: #1e293b; border: 3px solid #b89130; border-radius: 12px; padding: 10px; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .card.off { opacity: 0.1; transform: scale(0.8) translateY(10px); filter: grayscale(1); }
        button, input, select { padding: 10px 15px; margin: 5px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; }
        .btn-confirm { background: #1e293b; color: #fff; border: 2px solid #fff; }
        .btn-guess { background: #16a34a; color: white; padding: 10px 25px; }
        #end-screen { display:none; position:fixed; inset:0; background: rgba(0,0,0,0.95); z-index:2000; justify-content:center; align-items:center; flex-direction:column; }
        #my-secret-display { color: #fde047; font-size: 1.4em; margin: 15px; font-weight: bold; }
    </style>
</head>
<body>

<div id="end-screen">
    <h1 id="end-title" style="font-size: 5em; margin: 0;"></h1>
    <p id="end-sub" style="font-size: 2em;"></p>
    <button onclick="location.reload()" style="background:#b89130; color:white; padding:15px 40px; font-size:1.5em; margin-top:30px;">××©×—×§ ×—×“×©</button>
</div>

<div class="top">
    <div id="setup">
        ×§×•×“ ×—×“×¨: <b id="myId" style="color:white; font-size:1.3em;">...</b> | 
        <input type="text" id="joinId" placeholder="×”×›× ×¡ ×§×•×“ ×™×¨×™×‘">
        <button onclick="join()">×”×ª×—×‘×¨</button>
    </div>
    
    <div id="gameUI" style="display:none">
        ×‘×—×¨ ××œ: <select id="sel"></select>
        <button id="lockBtn" class="btn-confirm" onclick="lockSecret()">×‘×—×¨×ª×™!</button>
        <button class="btn-guess" id="guessBtn" onclick="guess()" style="display:none;">×× ×™ ×™×•×“×¢ ××™ ×–×”!</button>
    </div>
</div>

<div id="status" style="margin:10px; color:#cbd5e1;">×˜×•×¢×Ÿ...</div>
<div id="my-secret-display"></div>
<div class="grid" id="board"></div>

<script>
    // ×¨×©×™××ª 30 ××œ×™× ×•×“××•×™×•×ª
    const gods = [
        {n:"×–××•×¡",i:"âš¡"},{n:"×”×¨×”",i:"ğŸ‘‘"},{n:"×¤×•×¡×™×“×•×Ÿ",i:"ğŸ”±"},{n:"××ª× ×”",i:"ğŸ¦‰"},{n:"××¨×¡",i:"âš”ï¸"},
        {n:"××¤×¨×•×“×™×˜×”",i:"ğŸ•Šï¸"},{n:"××¤×•×œ×•",i:"â˜€ï¸"},{n:"××¨×˜××™×¡",i:"ğŸ¹"},{n:"×”××“×¡",i:"ğŸ’€"},{n:"×”×¤×™×¡×˜×•×¡",i:"ğŸ”¨"},
        {n:"×”×¨××¡",i:"ğŸ‘Ÿ"},{n:"×“×™×•× ×™×¡×•×¡",i:"ğŸ‡"},{n:"×“××˜×¨",i:"ğŸŒ¾"},{n:"×”×¡×˜×™×”",i:"ğŸ”¥"},{n:"×¤×¨×•××ª××•×¡",i:"ğŸ•¯ï¸"},
        {n:"×¤××Ÿ",i:"ğŸ"},{n:"×¤×¨×¡××•×¡",i:"ğŸ›¡ï¸"},{n:"×”×§××˜×™",i:"ğŸŒ™"},{n:"× ×™×§×”",i:"ğŸ†"},{n:"×”×œ×™×•×¡",i:"ğŸŒ…"},
        {n:"××˜×œ×¡",i:"ğŸŒ"},{n:"×§×¨×•× ×•×¡",i:"â³"},{n:"×¨×™××”",i:"ğŸ”ï¸"},{n:"×”×¨×§×•×œ×¡",i:"ğŸ¦"},{n:"××›×™×œ×¡",i:"ğŸ—¡ï¸"},
        {n:"××“×•×–×”",i:"ğŸ"},{n:"× ×¨×§×™×¡×•×¡",i:"ğŸŒ·"},{n:"×¤× ×“×•×¨×”",i:"ğŸ“¦"},{n:"××™×§×¨×•×¡",i:"× "},{n:"××¨×•×¡",i:"ğŸ’˜"}
    ];

    // ×¡××•× ×“×™× (××©×ª××© ×‘×¡×™× ×ª×–×” ×©×œ ×”×“×¤×“×¤×Ÿ ×›×“×™ ×œ× ×œ×”×–×“×§×§ ×œ×§×‘×¦×™× ×—×™×¦×•× ×™×™×)
    const playSound = (type) => {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain); gain.connect(ctx.destination);
        
        if(type === 'click') {
            osc.frequency.setValueAtTime(150, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
            osc.start(); osc.stop(ctx.currentTime + 0.1);
        } else if(type === 'win') {
            [440, 554, 659].forEach((f, i) => {
                const o = ctx.createOscillator(); o.connect(gain);
                o.frequency.setValueAtTime(f, ctx.currentTime + i*0.1);
                o.start(ctx.currentTime + i*0.1); o.stop(ctx.currentTime + 0.5);
            });
        } else if(type === 'fail') {
            osc.frequency.setValueAtTime(100, ctx.currentTime);
            osc.frequency.linearRampToValueAtTime(50, ctx.currentTime + 0.3);
            gain.gain.fadeOut = 0.3;
            osc.start(); osc.stop(ctx.currentTime + 0.3);
        }
    };

    let peer, conn, mySecret = "", enemySecret = "";
    const shortId = Math.floor(1000 + Math.random() * 9000).toString();
    peer = new Peer(shortId);

    peer.on('open', id => { document.getElementById('myId').innerText = id; });
    peer.on('connection', c => { conn = c; setup(); });

    function join() { conn = peer.connect(document.getElementById('joinId').value); setup(); }

    function setup() {
        conn.on('open', () => {
            playSound('win');
            document.getElementById('status').innerText = "××—×•×‘×¨! ×‘×—×¨ ×“××•×ª.";
            document.getElementById('setup').style.display = "none";
            document.getElementById('gameUI').style.display = "block";
            render();
        });
        conn.on('data', d => {
            if(d.type === 'secret') { enemySecret = d.value; document.getElementById('status').innerText = "×”×™×¨×™×‘ ××•×›×Ÿ!"; }
            if(d.type === 'gameOver') showEndScreen(false, d.yourGod);
        });
    }

    function render() {
        const b = document.getElementById('board'), s = document.getElementById('sel');
        b.innerHTML = ''; s.innerHTML = '<option value="">--×‘×—×¨ ×“××•×ª--</option>';
        gods.sort((a,b)=>a.n.localeCompare(b.n)).forEach(g => {
            s.innerHTML += `<option value="${g.n}">${g.n}</option>`;
            const c = document.createElement('div');
            c.className = 'card';
            c.innerHTML = `<div style="font-size:35px">${g.i}</div><b>${g.n}</b>`;
            c.onclick = () => { playSound('click'); c.classList.toggle('off'); };
            b.appendChild(c);
        });
    }

    function lockSecret() {
        const v = document.getElementById('sel').value;
        if(!v) return;
        mySecret = v;
        document.getElementById('my-secret-display').innerText = "×”×¡×•×“ ×©×œ×š: " + v;
        document.getElementById('lockBtn').style.display = "none";
        document.getElementById('sel').disabled = true;
        document.getElementById('guessBtn').style.display = "inline-block";
        conn.send({type: 'secret', value: v});
        playSound('win');
    }

    function guess() {
        if(!enemySecret) return alert("×”×™×¨×™×‘ ×¢×•×“ ×œ× ×‘×—×¨!");
        const a = prompt("××™ ×”×™×¨×™×‘?");
        if(!a) return;
        if(a.trim() === enemySecret) {
            playSound('win');
            conn.send({type: 'gameOver', yourGod: enemySecret});
            showEndScreen(true);
        } else {
            playSound('fail');
            alert("×˜×¢×•×ª!");
        }
    }

    function showEndScreen(isWin, god) {
        const screen = document.getElementById('end-screen');
        screen.style.display = "flex";
        if(isWin) {
            document.getElementById('end-title').innerText = "× ×™×¦×—×ª! ğŸ‰";
            document.getElementById('end-title').style.color = "#4ade80";
            document.getElementById('end-sub').innerText = "××ª×” ××œ×•×£ ×”××•×œ×™××¤×•×¡!";
        } else {
            document.getElementById('end-title').innerText = "×”×¤×¡×“×ª! ğŸ’€";
            document.getElementById('end-title').style.color = "#f87171";
            document.getElementById('end-sub').innerText = `×”×™×¨×™×‘ ×’×™×œ×” ×©××ª×” ${god}`;
        }
    }
</script>
</body>
</html>